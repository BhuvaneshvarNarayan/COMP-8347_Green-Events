{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h1>Profile</h1>
    <div id="profile-info">
        {% if user %}
        <p><strong>Username:</strong> {{ user.username }}</p>
        <p><strong>First Name:</strong> {{ user.first_name }}</p>
        <p><strong>Last Name:</strong> {{ user.last_name }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Bio:</strong> {{ user.profile.bio }}</p>
        <p><strong>Pronouns:</strong> {{ user.profile.pronouns }}</p>
        <p><strong>Mobile Number:</strong> {{ user.profile.mobile_no }}</p>
        <p><strong>Profile Picture:</strong></p>
        {% if user.profile.profile_picture %}
            <img src="{{ user.profile.profile_picture.url }}" alt="Profile Picture" width="150" height="150">
        {% else %}
            <p>No profile picture uploaded.</p>
        {% endif %}
        {% endif %}
        <button id="edit-profile-btn" class="btn btn-secondary mt-3">Edit Profile</button>
    </div>
    <form id="profile-form" method="post" enctype="multipart/form-data" style="display: none;">
        {% csrf_token %}
        <fieldset>
            <legend>Personal Info</legend>
            {{ user_form.as_p }}
        </fieldset>
        <fieldset>
            <legend>Profile Info</legend>
            {{ profile_form.as_p }}
        </fieldset>
        <button type="submit" class="btn btn-primary">Save Changes</button>
        <button type="button" id="cancel-edit-btn" class="btn btn-secondary">Cancel</button>
    </form>
    <h2>Past Events</h2>
    <ul>
        {% for event in user.profile.past_events.all %}
        <li>{{ event.name }}</li>
        {% endfor %}
    </ul>
    <h2>Upcoming Events</h2>
    <ul>
        {% for event in user.profile.upcoming_events.all %}
        <li>{{ event.name }}</li>
        {% endfor %}
    </ul>
</div>

<script>
    document.getElementById('edit-profile-btn').addEventListener('click', function() {
        document.getElementById('profile-info').style.display = 'none';
        document.getElementById('profile-form').style.display = 'block';
    });

    document.getElementById('cancel-edit-btn').addEventListener('click', function() {
        document.getElementById('profile-form').style.display = 'none';
        document.getElementById('profile-info').style.display = 'block';
    });
</script>
{% endblock %}
